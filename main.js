/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => OthTool
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var import_child_process = require("child_process");
var import_fs = require("fs");
var DEFAULT_SETTINGS = {
  pythonPath: "/usr/bin/python3",
  othToolPath: "",
  mensaplanFile: "Mensaplan.md",
  cloneRepo: false,
  autoOpen: true
};
var OthTool = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.oth_tool_repo_url = "https://github.com/Acoiny/oth-scrape-tool";
  }
  async onload() {
    await this.loadSettings();
    let vaultPath = "";
    if (this.app.vault.adapter instanceof import_obsidian.FileSystemAdapter) {
      vaultPath = this.app.vault.adapter.getBasePath();
    }
    this.vault_base_path = vaultPath;
    this.oth_tool_repo_path = vaultPath + "/" + this.manifest.dir + "/oth-scrape-tool";
    if (this.settings.cloneRepo) {
      this.updateRepo();
    }
    this.addCommand({
      id: "fetch-oth-mensaplan",
      name: "Fetch OTH-Mensaplan",
      callback: () => {
        this.fetchMensaplan();
      }
    });
    this.addCommand({
      id: "clone-oth-scrape-tool",
      name: "Clone the oth-scrape-tool",
      callback: () => {
        this.updateRepo();
      }
    });
    this.addCommand({
      id: "remove-oth-scrape-tool",
      name: "Remove the cloned oth-scrape-tool",
      callback: () => {
        if ((0, import_fs.existsSync)(this.oth_tool_repo_path)) {
          (0, import_fs.rm)(this.oth_tool_repo_path, { force: true, recursive: true }, (error) => {
            if (error)
              new OthToolModal(this.app, `Unable to remove tool: ${error}`).open();
          });
        }
      }
    });
    this.addSettingTab(new SampleSettingTab(this.app, this));
  }
  onunload() {
  }
  /**
   * Executes git pull inside the repo,
   * or freshly clones it if it isn't present
   */
  updateRepo() {
    if (!(0, import_fs.existsSync)(this.oth_tool_repo_path)) {
      this.cloneRepoIfNotExists();
      return;
    }
    const cmd = `cd ${this.oth_tool_repo_path} && git pull`;
    console.log(cmd);
    (0, import_child_process.exec)(cmd, (error, stdout, stderr) => {
      if (error) {
        new OthToolModal(this.app, `Error git pull: ${error}`).open();
        return;
      }
      console.log(stdout);
      if (stderr)
        console.error(stderr);
    });
  }
  cloneRepoIfNotExists() {
    if ((0, import_fs.existsSync)(this.oth_tool_repo_path))
      return;
    const cmd = `git clone ${this.oth_tool_repo_url} ${this.oth_tool_repo_path}`;
    (0, import_child_process.exec)(cmd, (error, stdout, stderr) => {
      if (error) {
        new OthToolModal(this.app, `Error on clone: ${error}`).open();
        return;
      }
      console.log(stdout);
      if (stderr)
        console.error(stderr);
    });
  }
  fetchMensaplan() {
    const pythonPath = this.settings.pythonPath;
    const mensaplan = this.settings.mensaplanFile;
    const cmd = `"${pythonPath}" "${this.oth_tool_repo_path + "/oth_tool.py"}" m -mt > "${this.vault_base_path + "/" + mensaplan}"`;
    console.log("Executing: ", cmd);
    (0, import_child_process.exec)(cmd, (error, stdout, stderr) => {
      var _a;
      if (error) {
        new OthToolModal(this.app, `Error on getting mensaplan: ${error}`).open();
        return;
      }
      console.log(stdout);
      if (stderr)
        console.error(stderr);
      if (this.settings.autoOpen) {
        const file = this.app.vault.getAbstractFileByPath(this.settings.mensaplanFile);
        if (file && file instanceof import_obsidian.TFile) {
          (_a = this.app.workspace.activeLeaf) == null ? void 0 : _a.openFile(file);
        }
      }
    });
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var OthToolModal = class extends import_obsidian.Modal {
  constructor(app, message) {
    super(app);
    this.message = message;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.setText(this.message);
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var SampleSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Python path").setDesc("Path to the python interpreter used to fetch the 				mensaplan. Can be inside a virtual environment (Recommended).").addText((text) => text.setPlaceholder("/path/to/python3").setValue(this.plugin.settings.pythonPath).onChange(async (value) => {
      this.plugin.settings.pythonPath = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Clone tool").setDesc("Automatically clone and pull new versions of the the oth-tool into this plugin's folder").addToggle((cp) => cp.setValue(this.plugin.settings.cloneRepo).onChange(async (value) => {
      this.plugin.settings.cloneRepo = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Mensaplan.md").setDesc("Path to store the mensaplan inside the vault.").addText((text) => text.setPlaceholder("Mensaplan.md").setValue(this.plugin.settings.mensaplanFile).onChange(async (value) => {
      this.plugin.settings.mensaplanFile = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBFZGl0b3IsIEZpbGVTeXN0ZW1BZGFwdGVyLCBNYXJrZG93blZpZXcsIE1vZGFsLCBOb3RpY2UsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5cbmltcG9ydCB7IGV4ZWMgfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcbmltcG9ydCB7IGV4aXN0c1N5bmMsIHJtIH0gZnJvbSAnZnMnO1xuXG4vLyBSZW1lbWJlciB0byByZW5hbWUgdGhlc2UgY2xhc3NlcyBhbmQgaW50ZXJmYWNlcyFcblxuaW50ZXJmYWNlIE15UGx1Z2luU2V0dGluZ3Mge1xuXHRweXRob25QYXRoOiBzdHJpbmc7XG5cdG90aFRvb2xQYXRoOiBzdHJpbmc7XG5cdG1lbnNhcGxhbkZpbGU6IHN0cmluZztcblx0Y2xvbmVSZXBvOiBib29sZWFuO1xuXHRhdXRvT3BlbjogYm9vbGVhbjsgLy8gYXV0b21hdGljYWxseSBvcGVuIHRoZSBtZW5zYXBsYW4gYWZ0ZXIgcHVsbGluZyBpdFxufVxuXG5cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTXlQbHVnaW5TZXR0aW5ncyA9IHtcblx0cHl0aG9uUGF0aDogJy91c3IvYmluL3B5dGhvbjMnLFxuXHRvdGhUb29sUGF0aDogJycsXG5cdG1lbnNhcGxhbkZpbGU6ICdNZW5zYXBsYW4ubWQnLFxuXHRjbG9uZVJlcG86IGZhbHNlLFxuXHRhdXRvT3BlbjogdHJ1ZSxcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgT3RoVG9vbCBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzOiBNeVBsdWdpblNldHRpbmdzO1xuXG5cdC8vIHBhdGggd2hlcmUgdGhlIG1lbnNhdG9vbCBzaG91bGQgYmUgY2xvbmVkIGludG9cblx0b3RoX3Rvb2xfcmVwb19wYXRoOiBzdHJpbmc7XG5cblx0dmF1bHRfYmFzZV9wYXRoOiBzdHJpbmc7XG5cblx0dmVudl9kYXRhOiB7IGJhc2VQYXRoOiBzdHJpbmcsIHB5dGhvbjogc3RyaW5nIH1cblxuXHRyZWFkb25seSBvdGhfdG9vbF9yZXBvX3VybDogc3RyaW5nID0gJ2h0dHBzOi8vZ2l0aHViLmNvbS9BY29pbnkvb3RoLXNjcmFwZS10b29sJztcblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXHRcdGxldCB2YXVsdFBhdGggPSAnJztcblx0XHRpZiAodGhpcy5hcHAudmF1bHQuYWRhcHRlciBpbnN0YW5jZW9mIEZpbGVTeXN0ZW1BZGFwdGVyKSB7XG5cdFx0XHR2YXVsdFBhdGggPSB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmdldEJhc2VQYXRoKCk7XG5cdFx0fVxuXHRcdHRoaXMudmF1bHRfYmFzZV9wYXRoID0gdmF1bHRQYXRoO1xuXG5cdFx0dGhpcy5vdGhfdG9vbF9yZXBvX3BhdGggPSB2YXVsdFBhdGggKyAnLycgKyB0aGlzLm1hbmlmZXN0LmRpciArICcvb3RoLXNjcmFwZS10b29sJztcblxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmNsb25lUmVwbykge1xuXHRcdFx0dGhpcy51cGRhdGVSZXBvKCk7XG5cdFx0fVxuXG5cdFx0Ly8gVGhpcyBhZGRzIGEgc2ltcGxlIGNvbW1hbmQgdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGFueXdoZXJlXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiAnZmV0Y2gtb3RoLW1lbnNhcGxhbicsXG5cdFx0XHRuYW1lOiAnRmV0Y2ggT1RILU1lbnNhcGxhbicsXG5cdFx0XHRjYWxsYmFjazogKCkgPT4ge1xuXHRcdFx0XHR0aGlzLmZldGNoTWVuc2FwbGFuKCk7XG5cdFx0XHRcdC8vbmV3IEVycm9yTW9kYWwodGhpcy5hcHAsIFwiVW5hYmxlIHRvIGZldGNoIG1lbnNhcGxhblwiKS5vcGVuKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6ICdjbG9uZS1vdGgtc2NyYXBlLXRvb2wnLFxuXHRcdFx0bmFtZTogJ0Nsb25lIHRoZSBvdGgtc2NyYXBlLXRvb2wnLFxuXHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0dGhpcy51cGRhdGVSZXBvKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6ICdyZW1vdmUtb3RoLXNjcmFwZS10b29sJyxcblx0XHRcdG5hbWU6ICdSZW1vdmUgdGhlIGNsb25lZCBvdGgtc2NyYXBlLXRvb2wnLFxuXHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0aWYgKGV4aXN0c1N5bmModGhpcy5vdGhfdG9vbF9yZXBvX3BhdGgpKSB7XG5cdFx0XHRcdFx0cm0odGhpcy5vdGhfdG9vbF9yZXBvX3BhdGgsIHsgZm9yY2U6IHRydWUsIHJlY3Vyc2l2ZTogdHJ1ZSB9LCAoZXJyb3IpID0+IHtcblx0XHRcdFx0XHRcdGlmIChlcnJvcilcblx0XHRcdFx0XHRcdFx0bmV3IE90aFRvb2xNb2RhbCh0aGlzLmFwcCwgYFVuYWJsZSB0byByZW1vdmUgdG9vbDogJHtlcnJvcn1gKS5vcGVuKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIFRPRE86IGFkZCBjb21tYW5kIHRvIHB1bGwgbWVuc2FwbGFuIEFORCBkaXJlY3RseSBvcGVuIGl0XG5cblx0XHQvLyBUaGlzIGFkZHMgYSBzZXR0aW5ncyB0YWIgc28gdGhlIHVzZXIgY2FuIGNvbmZpZ3VyZSB2YXJpb3VzIGFzcGVjdHMgb2YgdGhlIHBsdWdpblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgU2FtcGxlU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG5cdFx0Ly8gSWYgdGhlIHBsdWdpbiBob29rcyB1cCBhbnkgZ2xvYmFsIERPTSBldmVudHMgKG9uIHBhcnRzIG9mIHRoZSBhcHAgdGhhdCBkb2Vzbid0IGJlbG9uZyB0byB0aGlzIHBsdWdpbilcblx0XHQvLyBVc2luZyB0aGlzIGZ1bmN0aW9uIHdpbGwgYXV0b21hdGljYWxseSByZW1vdmUgdGhlIGV2ZW50IGxpc3RlbmVyIHdoZW4gdGhpcyBwbHVnaW4gaXMgZGlzYWJsZWQuXG5cdFx0Ly8gdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAnY2xpY2snLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0Ly8gXHRjb25zb2xlLmxvZygnY2xpY2snLCBldnQpO1xuXHRcdC8vIH0pO1xuXG5cdFx0Ly8gV2hlbiByZWdpc3RlcmluZyBpbnRlcnZhbHMsIHRoaXMgZnVuY3Rpb24gd2lsbCBhdXRvbWF0aWNhbGx5IGNsZWFyIHRoZSBpbnRlcnZhbCB3aGVuIHRoZSBwbHVnaW4gaXMgZGlzYWJsZWQuXG5cdFx0Ly8gdGhpcy5yZWdpc3RlckludGVydmFsKHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiBjb25zb2xlLmxvZygnc2V0SW50ZXJ2YWwnKSwgNSAqIDYwICogMTAwMCkpO1xuXHR9XG5cblx0b251bmxvYWQoKSB7XG5cblx0fVxuXG5cdC8qKlxuXHQgKiBFeGVjdXRlcyBnaXQgcHVsbCBpbnNpZGUgdGhlIHJlcG8sXG5cdCAqIG9yIGZyZXNobHkgY2xvbmVzIGl0IGlmIGl0IGlzbid0IHByZXNlbnRcblx0ICovXG5cdHVwZGF0ZVJlcG8oKSB7XG5cdFx0aWYgKCFleGlzdHNTeW5jKHRoaXMub3RoX3Rvb2xfcmVwb19wYXRoKSkge1xuXHRcdFx0dGhpcy5jbG9uZVJlcG9JZk5vdEV4aXN0cygpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRjb25zdCBjbWQgPSBgY2QgJHt0aGlzLm90aF90b29sX3JlcG9fcGF0aH0gJiYgZ2l0IHB1bGxgO1xuXHRcdGNvbnNvbGUubG9nKGNtZCk7XG5cdFx0ZXhlYyhjbWQsIChlcnJvciwgc3Rkb3V0LCBzdGRlcnIpID0+IHtcblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRuZXcgT3RoVG9vbE1vZGFsKHRoaXMuYXBwLCBgRXJyb3IgZ2l0IHB1bGw6ICR7ZXJyb3J9YCkub3BlbigpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRjb25zb2xlLmxvZyhzdGRvdXQpO1xuXHRcdFx0aWYgKHN0ZGVycilcblx0XHRcdFx0Y29uc29sZS5lcnJvcihzdGRlcnIpO1xuXHRcdH0pO1xuXHR9XG5cblx0Y2xvbmVSZXBvSWZOb3RFeGlzdHMoKSB7XG5cdFx0aWYgKGV4aXN0c1N5bmModGhpcy5vdGhfdG9vbF9yZXBvX3BhdGgpKSByZXR1cm47XG5cblx0XHRjb25zdCBjbWQgPSBgZ2l0IGNsb25lICR7dGhpcy5vdGhfdG9vbF9yZXBvX3VybH0gJHt0aGlzLm90aF90b29sX3JlcG9fcGF0aH1gO1xuXG5cdFx0ZXhlYyhjbWQsIChlcnJvciwgc3Rkb3V0LCBzdGRlcnIpID0+IHtcblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRuZXcgT3RoVG9vbE1vZGFsKHRoaXMuYXBwLCBgRXJyb3Igb24gY2xvbmU6ICR7ZXJyb3J9YCkub3BlbigpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRjb25zb2xlLmxvZyhzdGRvdXQpO1xuXHRcdFx0aWYgKHN0ZGVycilcblx0XHRcdFx0Y29uc29sZS5lcnJvcihzdGRlcnIpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gbm93IGNyZWF0ZSB0aGUgdmVudlxuXHR9XG5cblx0ZmV0Y2hNZW5zYXBsYW4oKSB7XG5cdFx0Y29uc3QgcHl0aG9uUGF0aCA9IHRoaXMuc2V0dGluZ3MucHl0aG9uUGF0aDtcblx0XHRjb25zdCBtZW5zYXBsYW4gPSB0aGlzLnNldHRpbmdzLm1lbnNhcGxhbkZpbGU7XG5cblx0XHRjb25zdCBjbWQgPSBgXCIke3B5dGhvblBhdGh9XCIgXCIke3RoaXMub3RoX3Rvb2xfcmVwb19wYXRoICsgJy9vdGhfdG9vbC5weSd9XCIgbSAtbXQgPiBcIiR7dGhpcy52YXVsdF9iYXNlX3BhdGggKyAnLycgKyBtZW5zYXBsYW59XCJgXG5cdFx0Y29uc29sZS5sb2coXCJFeGVjdXRpbmc6IFwiLCBjbWQpO1xuXHRcdGV4ZWMoY21kLCAoZXJyb3IsIHN0ZG91dCwgc3RkZXJyKSA9PiB7XG5cdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0bmV3IE90aFRvb2xNb2RhbCh0aGlzLmFwcCwgYEVycm9yIG9uIGdldHRpbmcgbWVuc2FwbGFuOiAke2Vycm9yfWApLm9wZW4oKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zb2xlLmxvZyhzdGRvdXQpO1xuXHRcdFx0aWYgKHN0ZGVycilcblx0XHRcdFx0Y29uc29sZS5lcnJvcihzdGRlcnIpO1xuXG5cdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5hdXRvT3Blbikge1xuXHRcdFx0XHRjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMuc2V0dGluZ3MubWVuc2FwbGFuRmlsZSk7XG5cdFx0XHRcdGlmIChmaWxlICYmIGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuXHRcdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVMZWFmPy5vcGVuRmlsZShmaWxlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuXHR9XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdH1cbn1cblxuXG5jbGFzcyBPdGhUb29sTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cdG1lc3NhZ2U6IHN0cmluZztcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgbWVzc2FnZTogc3RyaW5nKSB7XG5cdFx0c3VwZXIoYXBwKTtcblx0XHR0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuXHR9XG5cblx0b25PcGVuKCkge1xuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXHRcdGNvbnRlbnRFbC5zZXRUZXh0KHRoaXMubWVzc2FnZSk7XG5cdH1cblxuXHRvbkNsb3NlKCkge1xuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xuXHR9XG59XG5cbmNsYXNzIFNhbXBsZVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcblx0cGx1Z2luOiBPdGhUb29sO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE90aFRvb2wpIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnUHl0aG9uIHBhdGgnKVxuXHRcdFx0LnNldERlc2MoJ1BhdGggdG8gdGhlIHB5dGhvbiBpbnRlcnByZXRlciB1c2VkIHRvIGZldGNoIHRoZSBcXFxuXHRcdFx0XHRtZW5zYXBsYW4uIENhbiBiZSBpbnNpZGUgYSB2aXJ0dWFsIGVudmlyb25tZW50IChSZWNvbW1lbmRlZCkuJylcblx0XHRcdC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuXHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJy9wYXRoL3RvL3B5dGhvbjMnKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHl0aG9uUGF0aClcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnB5dGhvblBhdGggPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnQ2xvbmUgdG9vbCcpXG5cdFx0XHQuc2V0RGVzYygnQXV0b21hdGljYWxseSBjbG9uZSBhbmQgcHVsbCBuZXcgdmVyc2lvbnMgb2YgdGhlIHRoZSBvdGgtdG9vbCBpbnRvIHRoaXMgcGx1Z2luXFwncyBmb2xkZXInKVxuXHRcdFx0LmFkZFRvZ2dsZShjcCA9PiBjcFxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xvbmVSZXBvKVxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgdmFsdWUgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmNsb25lUmVwbyA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdNZW5zYXBsYW4ubWQnKVxuXHRcdFx0LnNldERlc2MoJ1BhdGggdG8gc3RvcmUgdGhlIG1lbnNhcGxhbiBpbnNpZGUgdGhlIHZhdWx0LicpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdNZW5zYXBsYW4ubWQnKVxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubWVuc2FwbGFuRmlsZSlcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLm1lbnNhcGxhbkZpbGUgPSB2YWx1ZTtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSkpO1xuXHR9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBQXNIO0FBRXRILDJC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
